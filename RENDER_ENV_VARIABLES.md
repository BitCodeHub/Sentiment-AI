# Render.com Environment Variables Setup

This document lists all the environment variables you need to configure in your Render.com services for the deployment to work correctly.

## Database Setup

1. **Create PostgreSQL Database in Render**
   - Go to your Render Dashboard
   - Click "New" → "PostgreSQL" 
   - Name it: `review-dashboard-db`
   - Choose your plan (Free tier works for testing)
   - Click "Create Database"

## Backend Service Environment Variables

Go to your backend service (`sentiment-review-backend`) → Environment tab and add these variables:

### Required Variables

#### Database (Automatically Linked)
- **DATABASE_URL** - This will be automatically set when you link your PostgreSQL database
  - In render.yaml, we use `fromDatabase` to link this automatically
  - No manual configuration needed

#### Authentication
- **JWT_SECRET** - Click "Generate" or use a secure random string
  - Example: `your-super-secret-jwt-key-here`

#### Apple API (Optional - for App Store reviews)
If you have Apple Developer credentials:
- **APPLE_ISSUER_ID** - Your Apple Issuer ID (from App Store Connect)
- **APPLE_KEY_ID** - Your Apple Private Key ID
- **APPLE_PRIVATE_KEY_BASE64** - Base64 encoded .p8 private key
  - To encode: `base64 -i AuthKey_XXXXXX.p8 | tr -d '\n'`

#### Reddit API (Optional - for Reddit integration)
If you have Reddit app credentials:
- **REDDIT_CLIENT_ID** - Your Reddit app client ID
- **REDDIT_CLIENT_SECRET** - Your Reddit app client secret

### Auto-Generated Variables
These are automatically set by Render:
- **PORT** - Auto-generated by Render
- **NODE_ENV** - Set to "production" in render.yaml

## Frontend Service Environment Variables

Go to your frontend service (`sentiment-review-dashboard`) → Environment tab:

### Required Variables
- **VITE_API_ENDPOINT** - `https://sentiment-review-backend.onrender.com`
  - Already set in render.yaml

### Optional Variables (for additional features)
- **VITE_OPENAI_API_KEY** - Your OpenAI API key (for AI features)
- **VITE_GEMINI_API_KEY** - Your Google Gemini API key (for AI analysis)

## Setting Environment Variables in Render

### Method 1: Through Render Dashboard
1. Go to your service in Render
2. Click on "Environment" tab
3. Click "Add Environment Variable"
4. Enter the Key and Value
5. For sensitive values, toggle "Sync" to OFF (makes it write-only)
6. Click "Save"

### Method 2: Using render.yaml
Most variables are already configured in render.yaml:
- Variables with `sync: false` need to be manually set in dashboard
- Variables with `generateValue: true` are auto-generated
- Variables with `fromDatabase` are linked from database

## Verification Checklist

After deployment, verify these are working:

1. **Database Connection**
   - Check backend logs for "[Database] Connection successful"
   - Visit: `https://sentiment-review-backend.onrender.com/api/health`

2. **Authentication**
   - Try creating a user account in the frontend
   - Check if login persists after refresh

3. **Frontend-Backend Connection**
   - Open browser console on frontend
   - Check for any CORS errors or connection failures

## Troubleshooting

### Database Connection Issues
- Ensure PostgreSQL database is active in Render
- Check DATABASE_URL is properly linked
- Look for connection errors in backend logs

### Authentication Not Working
- Verify JWT_SECRET is set
- Check for auth errors in backend logs
- Ensure cookies are enabled for cross-site requests

### Frontend Can't Reach Backend
- Verify VITE_API_ENDPOINT is correct
- Check CORS settings in backend
- Ensure both services are deployed and running

## Security Notes
- Never commit sensitive values to git
- Use Render's "sync: false" for sensitive variables
- Rotate JWT_SECRET periodically
- Keep API keys secure and limit their scope